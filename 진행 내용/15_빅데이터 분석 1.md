# 빅데이터 분석 1

- Impala(임팔라)
- Zeppelin(제플린)
- Mahout(머하웃)
- Sqoop(스쿱)

> 각각 구성

<hr>

## Impala 이용
> 기존 Hive에서 30초 이상 걸렸던 걸과가 파일럿 환경에서 2초 내로 조회되면서 **대화형 분석**이 가능해진다.

`select * from managed_smartcar_symptom_info where biz_date = '20210901'`

- 긴급 점검이 필요한 스마트카 정보 조회

`select * from Managed_SmartCar_Emergency_Check_Info where biz_date = '20210901'`

- 스마트카 차량정보 조회

`select * from managed_smartcar_item_buylist_info where biz_month = '202109'`

<hr>

#### 운행 지역 분석

```
select T2.area_number, T2.car_number, T2.speed_avg

from (
    select
        T1.area_number,
        T1.car_number,
        T1.speed_avg,
        rank() over(partition by T1.area_number order by T1.speed_avg desc) as ranking
    from ( 
        select area_number, car_number, avg(cast(speed as int)) as speed_avg
        from managed_smartcar_drive_info
        group by area_number, car_number
    ) T1
) T2
where ranking = 1
```

- rank()를 통해 지역마다 평균 속도가 높은 순서대로 순위를 매기게 된다.
- ranking이 1인 (가속을 가장 많이 한 차량을 뽑는다)
